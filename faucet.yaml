version: 2

acls:
  mgmt_port_security:
    - rule:
        description: "Allow only known management MAC"
        dl_src: "00:00:00:00:00:03"
        actions:
          allow: 1
    - rule:
        description: "Drop unknown MACs"
        actions:
          allow: 0



vlans:
  employees:
    vid: 10
    description: "Employees VLAN"
    faucet_vips: ["10.0.10.1/24"]
    routes:
      - route:
          ip_dst: "0.0.0.0/0"
          ip_gw: "203.0.113.1"

  guests:
    vid: 20
    description: "Guests VLAN"
    faucet_vips: ["10.0.20.1/24"]
    routes:
      - route:
          ip_dst: "0.0.0.0/0"
          ip_gw: "203.0.113.1"

  management:
    vid: 30
    description: "Management VLAN"
    faucet_vips: ["10.0.30.1/24"]
    acl_in: mgmt_port_security
    routes:
      - route:
          ip_dst: "0.0.0.0/0"
          ip_gw: "203.0.113.1"

  isp:
    vid: 99
    description: "ISP VLAN"
    faucet_vips: ["203.0.113.14/28"]

dps:
  s1:
    dp_id: 0x1
    hardware: "Open vSwitch"
    interfaces:
      1:
        name: "A-employees_port"
        native_vlan: employees
      2:
        name: "A-guests_port"
        native_vlan: guests
      3:
        name: "A-management_port"
        native_vlan: management
      10:
        name: "trunk_to_s2"
        tagged_vlans: [employees, guests, management, isp]
      20:
        name: "A-ISP_port"
        native_vlan: isp

  s2:
    dp_id: 0x2
    hardware: "Open vSwitch"
    interfaces:
      1:
        name: "B-employees_port"
        native_vlan: employees
      2:
        name: "B-guests_port"
        native_vlan: guests
      3:
        name: "B-management_port"
        native_vlan: management
      10:
        name: "trunk_to_s1"
        tagged_vlans: [employees, guests, management, isp]
      20:
        name: "B-ISP_port"
        native_vlan: isp
